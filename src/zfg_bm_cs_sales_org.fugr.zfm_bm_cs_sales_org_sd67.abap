FUNCTION ZFM_BM_CS_SALES_ORG_SD67.
*"----------------------------------------------------------------------
*"*"Local Interface:
*"  IMPORTING
*"     REFERENCE(I_DATA) TYPE  ZST_BM_SALES_SD67
*"----------------------------------------------------------------------
  DATA: LSS_T685 TYPE T685,
        LS_T685T TYPE T685T.

  GS_DATASD67 = I_DATA.
  SELECT SINGLE
      T685~KVEWE ,
      T685~KAPPL ,
      T685~KSCHL,
      T685T~VTEXT,
      T685~KOZGF ,
      T685~DATVO ,
      T685T~SPRAS ,
      T685~DTVOB
      FROM T685
    INNER JOIN T685T
    ON T685T~KVEWE = T685~KVEWE
    AND T685T~KAPPL = T685~KAPPL
    AND T685T~KSCHL = T685~KSCHL
       INTO  CORRESPONDING FIELDS OF @GT_SD67
    WHERE
    T685T~KVEWE = @GS_DATASD67-KVEWE
    AND T685T~KAPPL = @GS_DATASD67-KAPPL
    AND T685T~KSCHL = @GS_DATASD67-KSCHL.
  IF SY-SUBRC IS INITIAL.
    GS_SD67-KVEWE = 'C'.
    GS_SD67-KAPPL = 'V'.
    GS_SD67-KSCHL = GS_DATASD67-KSCHL.
    GS_SD67-KOZGF = GS_DATASD67-KOZGF.
    GS_SD67-DATVO = GS_DATASD67-DATVO.
    GS_SD67-DTVOB = GS_DATASD67-DTVOB.
    GS_SD67-VTEXT = GS_DATASD67-VTEXT.
    GS_SD67-SPRAS = SY-LANGU.


    MOVE-CORRESPONDING GS_SD67 TO LSS_T685.
    MOVE-CORRESPONDING GS_SD67 TO LS_T685T.
    UPDATE  T685 FROM LSS_T685.
    UPDATE  T685T FROM LS_T685T.

  ELSE.
    GS_SD67-KVEWE = 'C'.
    GS_SD67-KAPPL = 'V'.
    GS_SD67-KSCHL = GS_DATASD67-KSCHL.
    GS_SD67-KOZGF = GS_DATASD67-KOZGF.
    GS_SD67-DATVO = GS_DATASD67-DATVO.
    GS_SD67-DTVOB = GS_DATASD67-DTVOB.
    GS_SD67-VTEXT = GS_DATASD67-VTEXT.
    GS_SD67-SPRAS = SY-LANGU.


    MOVE-CORRESPONDING GS_SD67 TO LSS_T685.
    MOVE-CORRESPONDING GS_SD67 TO LS_T685T.
    INSERT  T685 FROM LSS_T685.
    INSERT  T685T FROM LS_T685T.
  ENDIF.
ENDFUNCTION.
