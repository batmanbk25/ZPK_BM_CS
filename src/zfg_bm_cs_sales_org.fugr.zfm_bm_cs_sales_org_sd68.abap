FUNCTION ZFM_BM_CS_SALES_ORG_SD68.
*"----------------------------------------------------------------------
*"*"Local Interface:
*"  IMPORTING
*"     REFERENCE(I_DATA) TYPE  ZST_BM_SALES_SD68
*"----------------------------------------------------------------------
  DATA: LSS_T683 TYPE T683,
        LS_T683U TYPE T683U.

  GS_DATASD68 = I_DATA.
  SELECT SINGLE
    T683~KVEWE,
    T683~KAPPL,
    T683~KALSM,
    T683U~VTEXT,
    T683U~SPRAS,
    T683~BONSM,
    T683~KNPRS_V,
    T683~PRODUCTIVE
      FROM T683
    INNER JOIN T683U
    ON T683U~KVEWE = T683~KVEWE
    AND T683U~KAPPL = T683~KAPPL
    AND T683U~KALSM = T683~KALSM
       INTO CORRESPONDING FIELDS OF  @GT_SD68
      WHERE T683~KVEWE = @GS_DATASD68-KVEWE
    AND T683~KAPPL = @GS_DATASD68-KAPPL
    AND T683~KALSM = @GS_DATASD68-KALSM.
  IF SY-SUBRC IS INITIAL.
*    PERFORM CHECKSD26.
    GS_SD68-KVEWE = 'C'.
    GS_SD68-KAPPL = 'V'.
    GS_SD68-KALSM = GS_DATASD68-KALSM.
    GS_SD68-VTEXT = GS_DATASD68-VTEXT.
    GS_SD68-BONSM = GS_DATASD68-BONSM.
    GS_SD68-KNPRS_V = GS_DATASD68-KNPRS_V.
    GS_SD68-PRODUCTIVE = GS_DATASD68-PRODUCTIVE.
    GS_SD68-SPRAS = SY-LANGU.

    MOVE-CORRESPONDING GS_SD68 TO LSS_T683.
    MOVE-CORRESPONDING GS_SD68 TO LS_T683U.

    UPDATE  T683 FROM LSS_T683.
    UPDATE  T683U FROM LS_T683U.
  ELSE.
    GS_SD68-KVEWE = 'C'.
    GS_SD68-KAPPL = 'V'.
    GS_SD68-KALSM = GS_DATASD68-KALSM.
    GS_SD68-VTEXT = GS_DATASD68-VTEXT.
    GS_SD68-BONSM = GS_DATASD68-BONSM.
    GS_SD68-KNPRS_V = GS_DATASD68-KNPRS_V.
    GS_SD68-PRODUCTIVE = GS_DATASD68-PRODUCTIVE.
    GS_SD68-SPRAS = SY-LANGU.

    MOVE-CORRESPONDING GS_SD68 TO LSS_T683.
    MOVE-CORRESPONDING GS_SD68 TO LS_T683U.

    INSERT  T683 FROM LSS_T683.
    INSERT  T683U FROM LS_T683U.
  ENDIF.
ENDFUNCTION.
