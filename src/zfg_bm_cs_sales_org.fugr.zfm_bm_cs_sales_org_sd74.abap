FUNCTION ZFM_BM_CS_SALES_ORG_SD74.
*"----------------------------------------------------------------------
*"*"Local Interface:
*"  IMPORTING
*"     REFERENCE(I_DATA) TYPE  ZST_BM_SALES_SD74
*"----------------------------------------------------------------------
 DATA: LSS_T682 TYPE T682,
        LS_T682T TYPE T682T.

  GS_DATASD74 = I_DATA.
  SELECT SINGLE
    T682~KVEWE,
    T682~KAPPL,
    T682~KOZGF,
    T682~KOZGV,
    T682~SYPSY,
    T682~SYSID,
    T682~SAPRL,
    T682~EXT_COUNTER_USED,
    T682T~VTXTM,
    T682T~SPRAS
      FROM T682
    INNER JOIN T682T
    ON T682T~KVEWE = T682~KVEWE
    AND T682T~KAPPL = T682~KAPPL
    AND T682T~KOZGF = T682~KOZGF
       INTO CORRESPONDING FIELDS OF  @GT_SD74
      WHERE T682~KVEWE = @GS_DATASD74-KVEWE
    AND T682~KAPPL = @GS_DATASD74-KAPPL
    AND T682~KOZGF = @GS_DATASD74-KOZGF.
  IF SY-SUBRC IS INITIAL.
*    PERFORM CHECKSD26.
    GS_SD74-KVEWE = 'C'.
    GS_SD74-KAPPL = 'VB'.
    GS_SD74-KOZGF = GS_DATASD74-KOZGF.
    GS_SD74-VTXTM = GS_DATASD74-VTXTM.
    GS_SD74-KOZGV = GS_DATASD74-KOZGV.
    GS_SD74-SYPSY = GS_DATASD74-SYPSY.
    GS_SD74-SYSID = GS_DATASD74-SYSID.
    GS_SD74-SAPRL = GS_DATASD74-SAPRL.
    GS_SD74-EXT_COUNTER_USED = GS_DATASD74-EXT_COUNTER_USED.
    GS_SD74-SPRAS = SY-LANGU.

    MOVE-CORRESPONDING GS_SD74 TO LSS_T682.
    MOVE-CORRESPONDING GS_SD74 TO LS_T682T.

    UPDATE  T682 FROM LSS_T682.
    UPDATE  T682T FROM LS_T682T.
  ELSE.
    GS_SD74-KVEWE = 'C'.
    GS_SD74-KAPPL = 'VB'.
    GS_SD74-KOZGF = GS_DATASD74-KOZGF.
    GS_SD74-VTXTM = GS_DATASD74-VTXTM.
    GS_SD74-KOZGV = GS_DATASD74-KOZGV.
    GS_SD74-SYPSY = GS_DATASD74-SYPSY.
    GS_SD74-SYSID = GS_DATASD74-SYSID.
    GS_SD74-SAPRL = GS_DATASD74-SAPRL.
    GS_SD74-EXT_COUNTER_USED = GS_DATASD74-EXT_COUNTER_USED.
    GS_SD74-SPRAS = SY-LANGU.

    MOVE-CORRESPONDING GS_SD74 TO LSS_T682.
    MOVE-CORRESPONDING GS_SD74 TO LS_T682T.

    INSERT  T682 FROM LSS_T682.
    INSERT  T682T FROM LS_T682T.
  ENDIF.
ENDFUNCTION.
