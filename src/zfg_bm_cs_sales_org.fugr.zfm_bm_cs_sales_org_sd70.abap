FUNCTION ZFM_BM_CS_SALES_ORG_SD70.
*"----------------------------------------------------------------------
*"*"Local Interface:
*"  IMPORTING
*"     REFERENCE(I_DATA) TYPE  ZST_BM_SALES_SD70
*"----------------------------------------------------------------------
  DATA: LSS_T687 TYPE T687,
        LS_T687T TYPE T687T.

  GS_DATASD70 = I_DATA.
  SELECT SINGLE
    T687~KAPPL,
    T687~KVSL1,
    T687T~VTEXT
      FROM T687
    INNER JOIN T687T
    ON T687T~KAPPL = T687~KAPPL
    AND T687T~KVSL1 = T687~KVSL1
       INTO CORRESPONDING FIELDS OF  @GT_SD70
      WHERE T687~KAPPL = @GS_DATASD70-KAPPL
    AND T687~KVSL1 = @GS_DATASD70-KVSL1.
  IF SY-SUBRC IS INITIAL.

    GS_SD70-KAPPL = 'V'.
    GS_SD70-KVSL1 = GS_DATASD70-KVSL1.
    GS_SD70-VTEXT = GS_DATASD70-VTEXT.
    GS_SD70-SPRAS = SY-LANGU.

    MOVE-CORRESPONDING GS_SD70 TO LSS_T687.
    MOVE-CORRESPONDING GS_SD70 TO LS_T687T.

    UPDATE  T687 FROM LSS_T687.
    UPDATE  T687T FROM LS_T687T.
  ELSE.

    GS_SD70-KAPPL = 'V'.
    GS_SD70-KVSL1 = GS_DATASD70-KVSL1.
    GS_SD70-VTEXT = GS_DATASD70-VTEXT.
    GS_SD70-SPRAS = SY-LANGU.

    MOVE-CORRESPONDING GS_SD70 TO LSS_T687.
    MOVE-CORRESPONDING GS_SD70 TO LS_T687T.

    INSERT  T687 FROM LSS_T687.
    INSERT  T687T FROM LS_T687T.
  ENDIF.
ENDFUNCTION.
